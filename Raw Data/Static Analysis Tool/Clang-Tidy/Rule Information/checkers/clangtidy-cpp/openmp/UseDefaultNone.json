{
  "name": "UseDefaultNone",
  "language": "cpp",
  "description": ".. title:: clang-tidy - openmp-use-default-none",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "cpp",
  "loc": 53,
  "branches": 2,
  "apis": 34,
  "test": [
    {
      "description": null,
      "expected-problems": 0,
      "expected-linenumbers": [],
      "code": "\n// RUN: %check_clang_tidy %s openmp-use-default-none %t -- -- -fopenmp=libomp -fopenmp-version=51\n// RUN: %check_clang_tidy -std=c11 %s openmp-use-default-none %t -- -- -x c -fopenmp=libomp -fopenmp-version=51\n\n//----------------------------------------------------------------------------//\n// Null cases.\n//----------------------------------------------------------------------------//\n\n// 'for' directive can not have 'default' clause, no diagnostics.\nvoid n0(const int a) {\n#pragma omp for\n  for (int b = 0; b < a; b++)\n    ;\n}\n\n//----------------------------------------------------------------------------//\n// Single-directive positive cases.\n//----------------------------------------------------------------------------//\n\n// 'parallel' directive.\n\n// 'parallel' directive can have 'default' clause, but said clause is not\n// specified, diagnosed.\nvoid p0_0(void) {\n#pragma omp parallel\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'parallel' does not specify 'default' clause, consider specifying 'default(none)' clause\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// with 'none' kind, all good.\nvoid p0_1(void) {\n#pragma omp parallel default(none)\n  ;\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// but with 'shared' kind, which is not 'none', diagnose.\nvoid p0_2(void) {\n#pragma omp parallel default(shared)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'parallel' specifies 'default(shared)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:22: note: existing 'default' clause specified here\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// but with 'firstprivate' kind, which is not 'none', diagnose.\nvoid p0_3(void) {\n#pragma omp parallel default(firstprivate)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'parallel' specifies 'default(firstprivate)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:22: note: existing 'default' clause specified here\n}\n\n// 'task' directive.\n\n// 'task' directive can have 'default' clause, but said clause is not\n// specified, diagnosed.\nvoid p1_0(void) {\n#pragma omp task\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'task' does not specify 'default' clause, consider specifying 'default(none)' clause\n}\n\n// 'task' directive can have 'default' clause, and said clause specified,\n// with 'none' kind, all good.\nvoid p1_1(void) {\n#pragma omp task default(none)\n  ;\n}\n\n// 'task' directive can have 'default' clause, and said clause specified,\n// but with 'shared' kind, which is not 'none', diagnose.\nvoid p1_2(void) {\n#pragma omp task default(shared)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'task' specifies 'default(shared)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:18: note: existing 'default' clause specified here\n}\n\n// 'task' directive can have 'default' clause, and said clause specified,\n// but with 'firstprivate' kind, which is not 'none', diagnose.\nvoid p1_3(void) {\n#pragma omp task default(firstprivate)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'task' specifies 'default(firstprivate)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:18: note: existing 'default' clause specified here\n}\n\n// 'teams' directive. (has to be inside of 'target' directive)\n\n// 'teams' directive can have 'default' clause, but said clause is not\n// specified, diagnosed.\nvoid p2_0(void) {\n#pragma omp target\n#pragma omp teams\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'teams' does not specify 'default' clause, consider specifying 'default(none)' clause\n}\n\n// 'teams' directive can have 'default' clause, and said clause specified,\n// with 'none' kind, all good.\nvoid p2_1(void) {\n#pragma omp target\n#pragma omp teams default(none)\n  ;\n}\n\n// 'teams' directive can have 'default' clause, and said clause specified,\n// but with 'shared' kind, which is not 'none', diagnose.\nvoid p2_2(void) {\n#pragma omp target\n#pragma omp teams default(shared)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'teams' specifies 'default(shared)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:19: note: existing 'default' clause specified here\n}\n\n// 'teams' directive can have 'default' clause, and said clause specified,\n// but with 'firstprivate' kind, which is not 'none', diagnose.\nvoid p2_3(void) {\n#pragma omp target\n#pragma omp teams default(firstprivate)\n  ;\n  // CHECK-NOTES: :[[@LINE-2]]:1: warning: OpenMP directive 'teams' specifies 'default(firstprivate)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-3]]:19: note: existing 'default' clause specified here\n}\n\n// 'taskloop' directive.\n\n// 'taskloop' directive can have 'default' clause, but said clause is not\n// specified, diagnosed.\nvoid p3_0(const int a) {\n#pragma omp taskloop\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'taskloop' does not specify 'default' clause, consider specifying 'default(none)' clause\n}\n\n// 'taskloop' directive can have 'default' clause, and said clause specified,\n// with 'none' kind, all good.\nvoid p3_1(const int a) {\n#pragma omp taskloop default(none) shared(a)\n  for (int b = 0; b < a; b++)\n    ;\n}\n\n// 'taskloop' directive can have 'default' clause, and said clause specified,\n// but with 'shared' kind, which is not 'none', diagnose.\nvoid p3_2(const int a) {\n#pragma omp taskloop default(shared)\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'taskloop' specifies 'default(shared)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-4]]:22: note: existing 'default' clause specified here\n}\n\n// 'taskloop' directive can have 'default' clause, and said clause specified,\n// but with 'firstprivate' kind, which is not 'none', diagnose.\nvoid p3_3(const int a) {\n#pragma omp taskloop default(firstprivate)\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'taskloop' specifies 'default(firstprivate)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-4]]:22: note: existing 'default' clause specified here\n}\n\n//----------------------------------------------------------------------------//\n// Combined directives.\n// Let's not test every single possible permutation/combination of directives,\n// but just *one* combined directive. The rest will be the same.\n//----------------------------------------------------------------------------//\n\n// 'parallel' directive can have 'default' clause, but said clause is not\n// specified, diagnosed.\nvoid p4_0(const int a) {\n#pragma omp parallel for\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'parallel for' does not specify 'default' clause, consider specifying 'default(none)' clause\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// with 'none' kind, all good.\nvoid p4_1(const int a) {\n#pragma omp parallel for default(none) shared(a)\n  for (int b = 0; b < a; b++)\n    ;\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// but with 'shared' kind, which is not 'none', diagnose.\nvoid p4_2(const int a) {\n#pragma omp parallel for default(shared)\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'parallel for' specifies 'default(shared)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-4]]:26: note: existing 'default' clause specified here\n}\n\n// 'parallel' directive can have 'default' clause, and said clause specified,\n// but with 'firstprivate' kind, which is not 'none', diagnose.\nvoid p4_3(const int a) {\n#pragma omp parallel for default(firstprivate)\n  for (int b = 0; b < a; b++)\n    ;\n  // CHECK-NOTES: :[[@LINE-3]]:1: warning: OpenMP directive 'parallel for' specifies 'default(firstprivate)' clause, consider using 'default(none)' clause instead\n  // CHECK-NOTES: :[[@LINE-4]]:26: note: existing 'default' clause specified here\n}"
    }
  ]
}
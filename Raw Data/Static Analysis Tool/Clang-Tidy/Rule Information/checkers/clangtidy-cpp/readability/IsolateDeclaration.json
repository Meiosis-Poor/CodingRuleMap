{
  "name": "IsolateDeclaration",
  "language": "cpp",
  "description": ".. title:: clang-tidy - readability-isolate-declaration",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "cpp",
  "loc": 274,
  "branches": 34,
  "apis": 160,
  "test": [
    {
      "description": null,
      "expected-problems": 46,
      "expected-linenumbers": [
        9,
        16,
        24,
        31,
        37,
        42,
        49,
        54,
        59,
        64,
        69,
        75,
        81,
        86,
        93,
        124,
        131,
        136,
        141,
        150,
        165,
        171,
        178,
        183,
        200,
        206,
        211,
        214,
        223,
        254,
        260,
        266,
        271,
        281,
        287,
        295,
        300,
        315,
        320,
        334,
        347,
        353,
        361,
        369,
        379,
        394
      ],
      "code": "\n// RUN: %check_clang_tidy %s readability-isolate-declaration %t -- -- -fexceptions\n\nvoid f() {\n  int i;\n}\n\nvoid f2() {\n  int i, j, *k, lala = 42;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int i;\n  // CHECK-FIXES: {{^  }}int j;\n  // CHECK-FIXES: {{^  }}int *k;\n  // CHECK-FIXES: {{^  }}int lala = 42;\n\n  int normal, weird = /* comment */ 42;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int normal;\n  // CHECK-FIXES: {{^  }}int weird = /* comment */ 42;\n\n  int /* here is a comment */ v1,\n      // another comment\n      v2 = 42 // Ok, more comments\n      ;\n  // CHECK-MESSAGES: [[@LINE-4]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int /* here is a comment */ v1;\n  // CHECK-FIXES: {{^  }}int /* here is a comment */ // another comment\n  // CHECK-FIXES: {{^      }}v2 = 42 // Ok, more comments\n  // CHECK-FIXES: {{^      }};\n\n  auto int1 = 42, int2 = 0, int3 = 43;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: auto int1 = 42;\n  // CHECK-FIXES: {{^  }}auto int2 = 0;\n  // CHECK-FIXES: {{^  }}auto int3 = 43;\n\n  decltype(auto) ptr1 = &int1, ptr2 = &int1;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: decltype(auto) ptr1 = &int1;\n  // CHECK-FIXES: {{^  }}decltype(auto) ptr2 = &int1;\n\n  decltype(k) ptr3 = &int1, ptr4 = &int1;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: decltype(k) ptr3 = &int1;\n  // CHECK-FIXES: {{^  }}decltype(k) ptr4 = &int1;\n}\n\nvoid f3() {\n  int i, *pointer1;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int i;\n  // CHECK-FIXES: {{^  }}int *pointer1;\n  //\n  int *pointer2 = nullptr, *pointer3 = &i;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int *pointer2 = nullptr;\n  // CHECK-FIXES: {{^  }}int *pointer3 = &i;\n\n  int *(i_ptr) = nullptr, *((i_ptr2));\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int *(i_ptr) = nullptr;\n  // CHECK-FIXES: {{^  }}int *((i_ptr2));\n\n  float(*f_ptr)[42], (((f_value))) = 42;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: float (*f_ptr)[42];\n  // CHECK-FIXES: {{^  }}float (((f_value))) = 42;\n\n  float(((*f_ptr2)))[42], ((*f_ptr3)), f_value2 = 42.f;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: float (((*f_ptr2)))[42];\n  // CHECK-FIXES: {{^  }}float ((*f_ptr3));\n  // CHECK-FIXES: {{^  }}float f_value2 = 42.f;\n\n  float(((*f_ptr4)))[42], *f_ptr5, ((f_value3));\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: float (((*f_ptr4)))[42];\n  // CHECK-FIXES: {{^  }}float *f_ptr5;\n  // CHECK-FIXES: {{^  }}float ((f_value3));\n\n  void(((*f2))(int)), (*g2)(int, float);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: void (((*f2))(int));\n  // CHECK-FIXES: {{^  }}void (*g2)(int, float);\n\n  float(*(*(*f_ptr6)))[42], (*f_ptr7);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: float (*(*(*f_ptr6)))[42];\n  // CHECK-FIXES: {{^  }}float (*f_ptr7);\n}\n\nvoid f4() {\n  double d = 42. /* foo */, z = 43., /* hi */ y, c /* */ /*  */, l = 2.;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: double d = 42. /* foo */;\n  // CHECK-FIXES: {{^  }}double z = 43.;\n  // CHECK-FIXES: {{^  }}double /* hi */ y;\n  // CHECK-FIXES: {{^  }}double c /* */ /*  */;\n  // CHECK-FIXES: {{^  }}double l = 2.;\n}\n\nstruct SomeClass {\n  SomeClass() = default;\n  SomeClass(int value);\n};\n\nclass Point {\n  double x;\n  double y;\n\npublic:\n  Point(double x, double y) : x(x), y(y) {}\n};\n\nclass Rectangle {\n  Point TopLeft;\n  Point BottomRight;\n\npublic:\n  Rectangle(Point TopLeft, Point BottomRight) : TopLeft(TopLeft), BottomRight(BottomRight) {}\n};\n\nvoid f5() {\n  SomeClass v1, v2(42), v3{42}, v4(42.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: SomeClass v1;\n  // CHECK-FIXES: {{^  }}SomeClass v2(42);\n  // CHECK-FIXES: {{^  }}SomeClass v3{42};\n  // CHECK-FIXES: {{^  }}SomeClass v4(42.5);\n\n  SomeClass v5 = 42, *p1 = nullptr;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: SomeClass v5 = 42;\n  // CHECK-FIXES: {{^  }}SomeClass *p1 = nullptr;\n\n  Point P1(0., 2.), P2{2., 0.};\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: Point P1(0., 2.);\n  // CHECK-FIXES: {{^  }}Point P2{2., 0.};\n\n  Rectangle R1({0., 0.}, {1., -2.}), R2{{0., 1.}, {1., 0.}}, R3(P1, P2), R4{P1, P2};\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: Rectangle R1({0., 0.}, {1., -2.});\n  // CHECK-FIXES: {{^  }}Rectangle R2{{[{][{]}}0., 1.}, {1., 0.{{[}][}]}};\n  // CHECK-FIXES: {{^  }}Rectangle R3(P1, P2);\n  // CHECK-FIXES: {{^  }}Rectangle R4{P1, P2};\n}\n\nvoid f6() {\n  int array1[] = {1, 2, 3, 4}, array2[] = {1, 2, 3}, value1, value2 = 42;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int array1[] = {1, 2, 3, 4};\n  // CHECK-FIXES: {{^  }}int array2[] = {1, 2, 3};\n  // CHECK-FIXES: {{^  }}int value1;\n  // CHECK-FIXES: {{^  }}int value2 = 42;\n}\n\ntemplate <typename T>\nstruct TemplatedType {\n  TemplatedType() = default;\n  TemplatedType(T value);\n};\n\nvoid f7() {\n  TemplatedType<int> TT1(42), TT2{42}, TT3;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: TemplatedType<int> TT1(42);\n  // CHECK-FIXES: {{^  }}TemplatedType<int> TT2{42};\n  // CHECK-FIXES: {{^  }}TemplatedType<int> TT3;\n  //\n  TemplatedType<int *> *TT4(nullptr), TT5, **TT6 = nullptr, *const *const TT7{nullptr};\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: TemplatedType<int *> *TT4(nullptr);\n  // CHECK-FIXES: {{^  }}TemplatedType<int *> TT5;\n  // CHECK-FIXES: {{^  }}TemplatedType<int *> **TT6 = nullptr;\n  // CHECK-FIXES: {{^  }}TemplatedType<int *> *const *const TT7{nullptr};\n\n  TemplatedType<int &> **TT8(nullptr), *TT9;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: TemplatedType<int &> **TT8(nullptr);\n  // CHECK-FIXES: {{^  }}TemplatedType<int &> *TT9;\n\n  TemplatedType<int *> TT10{nullptr}, *TT11(nullptr);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: TemplatedType<int *> TT10{nullptr};\n  // CHECK-FIXES: {{^  }}TemplatedType<int *> *TT11(nullptr);\n}\n\nvoid forbidden_transformations() {\n  for (int i = 0, j = 42; i < j; ++i)\n    ;\n}\n\n#define NULL 0\n#define MY_NICE_TYPE int **\n#define VAR_NAME(name) name##__LINE__\n#define A_BUNCH_OF_VARIABLES int m1 = 42, m2 = 43, m3 = 44;\n\nvoid macros() {\n  int *p1 = NULL, *p2 = NULL;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int *p1 = NULL;\n  // CHECK-FIXES: {{^  }}int *p2 = NULL;\n\n  // Macros are involved, so there will be no transformation\n  MY_NICE_TYPE p3, v1, v2;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n\n  int VAR_NAME(v3),\n      VAR_NAME(v4),\n      VAR_NAME(v5);\n  // CHECK-MESSAGES: [[@LINE-3]]:3: warning: multiple declarations in a single statement reduces readability\n\n  A_BUNCH_OF_VARIABLES\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n\n  int Unconditional,\n  // Explanatory comment.\n#if CONFIGURATION\n      IfConfigured = 42,\n#else\n      IfConfigured = 0;\n#endif\n  // CHECK-MESSAGES: [[@LINE-7]]:3: warning: multiple declarations in a single statement reduces readability\n}\n\nvoid dontTouchParameter(int param1, int param2) {}\n\nstruct StructOne {\n  StructOne() {}\n  StructOne(int b) {}\n\n  int member1, member2;\n  // TODO: Handle FieldDecl's as well\n};\n\nusing PointerType = int;\n\nstruct {\n  int i;\n} AS1, AS2;\nstruct TemT {\n  template <typename T>\n  T *getAs() {\n    return nullptr;\n  }\n} TT1, TT2;\n\nvoid complex_typedefs() {\n  typedef int *IntPtr;\n  typedef int ArrayType[2];\n  typedef int FunType(void);\n\n  IntPtr intptr1, intptr2 = nullptr, intptr3;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: IntPtr intptr1;\n  // CHECK-FIXES: {{^  }}IntPtr intptr2 = nullptr;\n  // CHECK-FIXES: {{^  }}IntPtr intptr3;\n\n  IntPtr *DoublePtr1 = nullptr, **TriplePtr, SinglePtr = nullptr;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: IntPtr *DoublePtr1 = nullptr;\n  // CHECK-FIXES: {{^  }}IntPtr **TriplePtr;\n  // CHECK-FIXES: {{^  }}IntPtr SinglePtr = nullptr;\n\n  IntPtr intptr_array1[2], intptr_array2[4] = {nullptr, nullptr, nullptr, nullptr};\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: IntPtr intptr_array1[2];\n  // CHECK-FIXES: {{^  }}IntPtr intptr_array2[4] = {nullptr, nullptr, nullptr, nullptr};\n\n  ArrayType arraytype1, arraytype2 = {1}, arraytype3;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: ArrayType arraytype1;\n  // CHECK-FIXES: {{^  }}ArrayType arraytype2 = {1};\n  // CHECK-FIXES: {{^  }}ArrayType arraytype3;\n\n  // Don't touch function declarations.\n  FunType funtype1, funtype2, functype3;\n\n  for (int index1 = 0, index2 = 0;;) {\n    int localFor1 = 1, localFor2 = 2;\n    // CHECK-MESSAGES: [[@LINE-1]]:5: warning: multiple declarations in a single statement reduces readability\n    // CHECK-FIXES: int localFor1 = 1;\n    // CHECK-FIXES: {{^    }}int localFor2 = 2;\n  }\n\n  StructOne s1, s2(23), s3, s4(3), *sptr = new StructOne(2);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: StructOne s1;\n  // CHECK-FIXES: {{^  }}StructOne s2(23);\n  // CHECK-FIXES: {{^  }}StructOne s3;\n  // CHECK-FIXES: {{^  }}StructOne s4(3);\n  // CHECK-FIXES: {{^  }}StructOne *sptr = new StructOne(2);\n\n  struct StructOne cs1, cs2(42);\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: struct StructOne cs1;\n  // CHECK-FIXES: {{^  }}struct StructOne cs2(42);\n\n  int *ptrArray[3], dummy, **ptrArray2[5], twoDim[2][3], *twoDimPtr[2][3];\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int *ptrArray[3];\n  // CHECK-FIXES: {{^  }}int dummy;\n  // CHECK-FIXES: {{^  }}int **ptrArray2[5];\n  // CHECK-FIXES: {{^  }}int twoDim[2][3];\n  // CHECK-FIXES: {{^  }}int *twoDimPtr[2][3];\n\n  {\n    void f1(int), g1(int, float);\n  }\n\n  {\n    void gg(int, float);\n\n    void (*f2)(int), (*g2)(int, float) = gg;\n    // CHECK-MESSAGES: [[@LINE-1]]:5: warning: multiple declarations in a single statement reduces readability\n    // CHECK-FIXES: void (*f2)(int);\n    // CHECK-FIXES: {{^    }}void (*g2)(int, float) = gg;\n\n    void /*(*/ (/*(*/ *f3)(int), (*g3)(int, float);\n    // CHECK-MESSAGES: [[@LINE-1]]:5: warning: multiple declarations in a single statement reduces readability\n    // CHECK-FIXES: void /*(*/ (/*(*/ *f3)(int);\n    // CHECK-FIXES: {{^    }}void /*(*/ (*g3)(int, float);\n  }\n\n  // clang-format off\n  auto returner = []() { return int(32); };\n  int intfunction = returner(), intarray[] =\n          {\n                  1,\n                  2,\n                  3,\n                  4\n          }, bb = 4;\n  // CHECK-MESSAGES: [[@LINE-7]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int intfunction = returner();\n  // CHECK-FIXES: {{^  }}int intarray[] =\n  // CHECK-FIXES: {{^          }}{\n  // CHECK-FIXES: {{^                  }}1,\n  // CHECK-FIXES: {{^                  }}2,\n  // CHECK-FIXES: {{^                  }}3,\n  // CHECK-FIXES: {{^                  }}4\n  // CHECK-FIXES: {{^          }}};\n  // CHECK-FIXES: {{^  }}int bb = 4;\n  // clang-format on\n\n  TemT *T1 = &TT1, *T2 = &TT2;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: TemT *T1 = &TT1;\n  // CHECK-FIXES: {{^  }}TemT *T2 = &TT2;\n\n  const PointerType *PT1 = T1->getAs<PointerType>(),\n                    *PT2 = T2->getAs<PointerType>();\n  // CHECK-MESSAGES: [[@LINE-2]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: const PointerType *PT1 = T1->getAs<PointerType>();\n  // CHECK-FIXES: {{^  }}const PointerType *PT2 = T2->getAs<PointerType>();\n\n  const int *p1 = nullptr;\n  const int *p2 = nullptr;\n\n  const int *&pref1 = p1, *&pref2 = p2;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: const int *&pref1 = p1;\n  // CHECK-FIXES: {{^  }}const int *&pref2 = p2;\n\n  // clang-format off\n  const char *literal1 = \"clang\"   \"test\"\\\n                         \"one\",\n             *literal2 = \"empty\", literal3[] = \"three\";\n  // CHECK-MESSAGES: [[@LINE-3]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: const char *literal1 = \"clang\"   \"test\"\\\n  // CHECK-FIXES: {{^                         }}\"one\";\n  // CHECK-FIXES: {{^  }}const char *literal2 = \"empty\";\n  // CHECK-FIXES: {{^  }}const char literal3[] = \"three\";\n  // clang-format on\n}\n\nvoid g() try {\n  int i, j;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: int i;\n  // CHECK-FIXES: {{^  }}int j;\n} catch (...) {\n}\n\nstruct S {\n  int a;\n  const int b;\n  void f() {}\n};\n\nvoid memberPointers() {\n  typedef const int S::*MemPtr;\n  MemPtr aaa = &S::a, bbb = &S::b;\n  // CHECK-MESSAGES: [[@LINE-1]]:3: warning: multiple declarations in a single statement reduces readability\n  // CHECK-FIXES: MemPtr aaa = &S::a;\n  // CHECK-FIXES: {{^  }}MemPtr bbb = &S::b;\n}\n\ntypedef int *tptr, tbt;\ntypedef int (&tfp)(int, long), tarr[10];\ntypedef int tarr2[10], tct;\n\ntemplate <typename A, typename B>\nvoid should_not_be_touched(A, B);\n\nint variable, function(void);\n\nint call_func_with_sideeffect();\nvoid bad_if_decl() {\n  if (true)\n    int i, j, k = call_func_with_sideeffect();\n}"
    }
  ]
}
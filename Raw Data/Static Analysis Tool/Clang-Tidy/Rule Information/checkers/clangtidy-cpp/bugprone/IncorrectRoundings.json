{
  "name": "IncorrectRoundings",
  "language": "cpp",
  "description": ".. title:: clang-tidy - bugprone-incorrect-roundings",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "cpp",
  "loc": 54,
  "branches": 1,
  "apis": 30,
  "test": [
    {
      "description": null,
      "expected-problems": 51,
      "expected-linenumbers": [
        12,
        14,
        16,
        18,
        20,
        22,
        24,
        26,
        28,
        30,
        32,
        34,
        36,
        38,
        40,
        42,
        44,
        46,
        48,
        50,
        52,
        54,
        56,
        58,
        60,
        62,
        64,
        66,
        68,
        70,
        72,
        74,
        76,
        78,
        80,
        82,
        84,
        86,
        88,
        90,
        92,
        94,
        96,
        98,
        100,
        102,
        104,
        106,
        108,
        110,
        112
      ],
      "code": "\n// RUN: %check_clang_tidy %s bugprone-incorrect-roundings %t\n\nvoid b(int x) {}\n\nvoid f1() {\n  float f;\n  double d;\n  long double ld;\n  int x;\n\n  x = (d + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5) to integer leads to incorrect rounding; consider using lround (#include <cmath>) instead [bugprone-incorrect-roundings]\n  x = (d + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (d + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (f + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (f + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (f + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5 + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5f + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5L + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5 + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5f + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5L + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5 + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5f + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (0.5L + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:7: warning: casting (double + 0.5)\n  x = (int)(d + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(d + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(d + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(ld + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(ld + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(ld + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(f + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(f + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(f + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5 + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5f + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5L + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5 + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5f + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5L + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5 + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5f + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = (int)(0.5L + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:12: warning: casting (double + 0.5)\n  x = static_cast<int>(d + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(d + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(d + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(ld + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(ld + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(ld + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(f + 0.5);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(f + 0.5f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(f + 0.5L);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5 + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5f + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5L + d);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5 + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5f + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5L + ld);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5 + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5f + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n  x = static_cast<int>(0.5L + f);\n  // CHECK-MESSAGES: [[@LINE-1]]:24: warning: casting (double + 0.5)\n\n  // Don't warn if constant is not 0.5.\n  x = (int)(d + 0.4999);\n  x = (int)(d + 0.4999f);\n  x = (int)(d + 0.4999L);\n  x = (int)(0.4999 + d);\n  x = (int)(0.4999f + d);\n  x = (int)(0.4999L + d);\n\n  x = (int)(d + -0.5);\n  x = (int)(-0.5 + d);\n  x = (int)(d + -0.5f);\n  x = (int)(-0.5f + d);\n  x = (int)(d + -0.5L);\n  x = (int)(-0.5L + d);\n\n  x = (int)(d + 0.5001);\n  x = (int)(d + 0.5001f);\n  x = (int)(d + 0.5001L);\n  x = (int)(0.5001 + d);\n  x = (int)(0.5001f + d);\n  x = (int)(0.5001L + d);\n\n  // Don't warn if binary operator is not directly beneath cast.\n  x = (int)(1 + (0.5 + f));\n}"
    }
  ]
}
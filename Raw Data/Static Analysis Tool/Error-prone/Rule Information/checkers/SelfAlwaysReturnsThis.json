{
  "name": "SelfAlwaysReturnsThis",
  "language": "java",
  "description": "Non-abstract instance methods named 'self()' or 'getThis()' that return the enclosing class must always 'return this'",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "java",
  "loc": 131,
  "branches": 8,
  "apis": 4,
  "test": [
    {
      "description": "selfReturnsThis",
      "expected-problems": null,
      "expected-linenumbers": [
        31
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return this;\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withCast",
      "expected-problems": null,
      "expected-linenumbers": [
        49
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return (Builder) this;\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withParenthesizedCast",
      "expected-problems": null,
      "expected-linenumbers": [
        67
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return ((Builder) (this));\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withCastAndTryCatch",
      "expected-problems": null,
      "expected-linenumbers": [
        85
      ],
      "code": ""
    },
    {
      "description": "selfReturnsThis_withMultipleReturnStatements",
      "expected-problems": null,
      "expected-linenumbers": [
        105
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                if (System.currentTimeMillis() % 2 == 0) {\n                  return this;\n                } else {\n                  return this;\n                }\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withTwoStatementCast",
      "expected-problems": null,
      "expected-linenumbers": [
        127
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                // sometimes people write comments here :-)\n                Builder self = (Builder) this;\n                return self;\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withImplComment",
      "expected-problems": null,
      "expected-linenumbers": [
        147
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                // this is an impl comment\n                return this;\n              }\n            }"
    },
    {
      "description": "selfReturnsThis_withInlineComment",
      "expected-problems": null,
      "expected-linenumbers": [
        166
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return /* self */ this;\n              }\n            }"
    },
    {
      "description": "selfReturnsNewBuilder",
      "expected-problems": null,
      "expected-linenumbers": [
        184
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return new Builder();\n              }\n            }\n            \n\n            package com.google.frobber;\n\n            public final class Builder {\n              public Builder self() {\n                return this;\n              }\n            }"
    },
    {
      "description": "getThisReturnsNewBuilder",
      "expected-problems": null,
      "expected-linenumbers": [
        212
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder getThis() {\n                return new Builder();\n              }\n            }\n            \n\n            package com.google.frobber;\n\n            public final class Builder {\n              public Builder getThis() {\n                return this;\n              }\n            }"
    },
    {
      "description": "self_voidReturn",
      "expected-problems": null,
      "expected-linenumbers": [
        240
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public void self() {}\n            }"
    },
    {
      "description": "self_differentReturnType",
      "expected-problems": null,
      "expected-linenumbers": [
        256
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public String self() {\n                return \"hi\";\n              }\n            }"
    },
    {
      "description": "self_static",
      "expected-problems": null,
      "expected-linenumbers": [
        274
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public static Builder self() {\n                return new Builder();\n              }\n            }"
    },
    {
      "description": "self_notNamedSelf",
      "expected-problems": null,
      "expected-linenumbers": [
        292
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder selfie() {\n                return new Builder();\n              }\n            }"
    },
    {
      "description": "self_hasParams",
      "expected-problems": null,
      "expected-linenumbers": [
        310
      ],
      "code": "package com.google.frobber;\n\n            public final class Builder {\n              public Builder self(int foo) {\n                return new Builder();\n              }\n            }"
    },
    {
      "description": "self_abstract",
      "expected-problems": null,
      "expected-linenumbers": [
        328
      ],
      "code": "package com.google.frobber;\n\n            public abstract class Builder {\n              public abstract Builder self();\n            }"
    }
  ]
}
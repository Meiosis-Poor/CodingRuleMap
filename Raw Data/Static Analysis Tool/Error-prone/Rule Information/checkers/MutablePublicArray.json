{
  "name": "MutablePublicArray",
  "language": "java",
  "description": "Non-empty arrays are mutable, so this `public static final` array is not a constant and can be modified by clients of this class.  Prefer an ImmutableList, or provide an accessor method that returns a defensive copy.",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "java",
  "loc": 72,
  "branches": 7,
  "apis": 1,
  "test": [
    {
      "description": "publicStaticFinalPrimitive",
      "expected-problems": null,
      "expected-linenumbers": [
        31
      ],
      "code": "class Test {\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final int[] array = new int[10];\n            }"
    },
    {
      "description": "publicStaticFinalInlineInitializer",
      "expected-problems": null,
      "expected-linenumbers": [
        45
      ],
      "code": "class Test {\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final String[] array = {\"foo\", \"bar\"};\n            }"
    },
    {
      "description": "publicStaticFinalObject",
      "expected-problems": null,
      "expected-linenumbers": [
        59
      ],
      "code": "class Test {\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final Test[] array = new Test[10];\n            }"
    },
    {
      "description": "publicStaticFinalObjectMultiDimension",
      "expected-problems": null,
      "expected-linenumbers": [
        73
      ],
      "code": "class Test {\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final Test[][] array = new Test[10][10];\n            }"
    },
    {
      "description": "privateStaticFinal_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        87
      ],
      "code": "class Test {\n              private static final int[] array = new int[10];\n            }"
    },
    {
      "description": "privateStaticFinalEmptyInlineInitializer_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        100
      ],
      "code": "class Test {\n              public static final String[] array = {};\n            }"
    },
    {
      "description": "privateFinal_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        113
      ],
      "code": "class Test {\n              private final int[] array = new int[10];\n            }"
    },
    {
      "description": "staticFinal_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        126
      ],
      "code": "class Test {\n              static final int[] array = new int[10];\n            }"
    },
    {
      "description": "zeroSizeOneDimensionArray_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        139
      ],
      "code": "class Test {\n              public static final int[] array = new int[0];\n            }"
    },
    {
      "description": "zeroSizeMultiDimensionArray_negative",
      "expected-problems": null,
      "expected-linenumbers": [
        152
      ],
      "code": "class Test {\n              public static final int[][] array = new int[0][0];\n            }"
    },
    {
      "description": "negative_datapoints",
      "expected-problems": null,
      "expected-linenumbers": [
        165
      ],
      "code": "import org.junit.experimental.theories.DataPoints;\n\n            class Test {\n              @DataPoints public static final int[] array = new int[10];\n            }"
    },
    {
      "description": "publicStaticFinalStaticInitializeBlock",
      "expected-problems": null,
      "expected-linenumbers": [
        180
      ],
      "code": "class Test {\n              public static final long[] l;\n\n              static {\n                l = new long[1];\n              }\n            }"
    },
    {
      "description": "notAnArray",
      "expected-problems": null,
      "expected-linenumbers": [
        197
      ],
      "code": "class Test {\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final long[] y = {0};\n              public static final long[] l = y;\n            }"
    },
    {
      "description": "i1645",
      "expected-problems": null,
      "expected-linenumbers": [
        212
      ],
      "code": "class Test {\n              public static final int zero = 0;\n              public static final int one = 1;\n              public static final long[] z1 = new long[zero];\n              public static final long[][] z2 = new long[zero][zero];\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final long[] o1 = new long[one];\n              // BUG: Diagnostic contains: MutablePublicArray\n              public static final long[][] o2 = new long[one][zero];\n            }"
    }
  ]
}
{
  "name": "FormatString",
  "language": "java",
  "description": "Invalid printf-style format string",
  "example": null,
  "cwe": null,
  "cwe-description": null,
  "checker-language": "java",
  "loc": 64,
  "branches": 7,
  "apis": 1,
  "test": [
    {
      "description": "duplicateFormatFlags",
      "expected-problems": null,
      "expected-linenumbers": [
        48
      ],
      "code": ""
    },
    {
      "description": "formatFlagsConversionMismatch",
      "expected-problems": null,
      "expected-linenumbers": [
        53
      ],
      "code": ""
    },
    {
      "description": "illegalFormatCodePoint",
      "expected-problems": null,
      "expected-linenumbers": [
        60
      ],
      "code": ""
    },
    {
      "description": "illegalFormatConversion",
      "expected-problems": null,
      "expected-linenumbers": [
        65
      ],
      "code": ""
    },
    {
      "description": "illegalFormatFlags",
      "expected-problems": null,
      "expected-linenumbers": [
        72
      ],
      "code": ""
    },
    {
      "description": "illegalFormatPrecision",
      "expected-problems": null,
      "expected-linenumbers": [
        77
      ],
      "code": ""
    },
    {
      "description": "illegalFormatWidth",
      "expected-problems": null,
      "expected-linenumbers": [
        82
      ],
      "code": ""
    },
    {
      "description": "missingFormatArgument",
      "expected-problems": null,
      "expected-linenumbers": [
        87
      ],
      "code": ""
    },
    {
      "description": "missingFormatWidth",
      "expected-problems": null,
      "expected-linenumbers": [
        92
      ],
      "code": ""
    },
    {
      "description": "unknownFormatConversion",
      "expected-problems": null,
      "expected-linenumbers": [
        97
      ],
      "code": ""
    },
    {
      "description": "cStyleLongConversion",
      "expected-problems": null,
      "expected-linenumbers": [
        102
      ],
      "code": ""
    },
    {
      "description": "cStyleLongConversion2",
      "expected-problems": null,
      "expected-linenumbers": [
        107
      ],
      "code": ""
    },
    {
      "description": "cStyleLongConversion3",
      "expected-problems": null,
      "expected-linenumbers": [
        112
      ],
      "code": ""
    },
    {
      "description": "cStyleLongConversion4",
      "expected-problems": null,
      "expected-linenumbers": [
        117
      ],
      "code": ""
    },
    {
      "description": "cStyleLongConversion5",
      "expected-problems": null,
      "expected-linenumbers": [
        122
      ],
      "code": ""
    },
    {
      "description": "conditionalExpression",
      "expected-problems": null,
      "expected-linenumbers": [
        127
      ],
      "code": ""
    },
    {
      "description": "conditionalExpression2",
      "expected-problems": null,
      "expected-linenumbers": [
        133
      ],
      "code": ""
    },
    {
      "description": "conditionalExpression3",
      "expected-problems": null,
      "expected-linenumbers": [
        139
      ],
      "code": ""
    },
    {
      "description": "conditionalExpression4",
      "expected-problems": null,
      "expected-linenumbers": [
        146
      ],
      "code": ""
    },
    {
      "description": "conditionalExpression5",
      "expected-problems": null,
      "expected-linenumbers": [
        153
      ],
      "code": ""
    },
    {
      "description": "missingArguments",
      "expected-problems": null,
      "expected-linenumbers": [
        160
      ],
      "code": "class Test {\n              void f() {\n                // BUG: Diagnostic contains: missing argument for format specifier '%s'\n                String.format(\"%s %s %s\", 42);\n                // BUG: Diagnostic contains: missing argument for format specifier '%s'\n                String.format(\"%s %s %s\", 42, 42);\n                String.format(\"%s %s %s\", 42, 42, 42);\n              }\n            }"
    },
    {
      "description": "extraArguments",
      "expected-problems": null,
      "expected-linenumbers": [
        179
      ],
      "code": "class Test {\n              void f() {\n                String.format(\"%s %s\", 1, 2);\n                // BUG: Diagnostic contains: extra format arguments: used 2, provided 3\n                String.format(\"%s %s\", 1, 2, 3);\n                // BUG: Diagnostic contains: extra format arguments: used 2, provided 4\n                String.format(\"%s %s\", 1, 2, 3, 4);\n                // BUG: Diagnostic contains: extra format arguments: used 0, provided 1\n                String.format(\"{0}\", 1);\n              }\n            }"
    },
    {
      "description": "negative",
      "expected-problems": null,
      "expected-linenumbers": [
        200
      ],
      "code": "class Test {\n              void f(boolean b) {\n                String.format(\"%d\", 42);\n                String.format(\"%d\", 42L);\n                String.format(\"%f\", 42.0f);\n                String.format(\"%f\", 42.0d);\n                String.format(\"%s\", \"hello\");\n                String.format(\"%s\", 42);\n                String.format(\"%s\", (Object) null);\n                String.format(\"%s\", new Object());\n                String.format(\"%c\", 'c');\n                String.format(b ? \"%s\" : \"%d\", 42);\n              }\n            }"
    },
    {
      "description": "printfMethods_stringFormat",
      "expected-problems": null,
      "expected-linenumbers": [
        224
      ],
      "code": ""
    },
    {
      "description": "printfMethods_stringFormatWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        229
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printWriterFormat",
      "expected-problems": null,
      "expected-linenumbers": [
        234
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printWriterFormatWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        239
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printWriterPrintf",
      "expected-problems": null,
      "expected-linenumbers": [
        244
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printWriterPrintfWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        249
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printStreamFormat",
      "expected-problems": null,
      "expected-linenumbers": [
        254
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printStreamFormatWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        259
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printStreamPrintf",
      "expected-problems": null,
      "expected-linenumbers": [
        264
      ],
      "code": ""
    },
    {
      "description": "printfMethods_printStreamPrintfWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        269
      ],
      "code": ""
    },
    {
      "description": "printfMethods_formatterFormatWithLocale",
      "expected-problems": null,
      "expected-linenumbers": [
        274
      ],
      "code": ""
    },
    {
      "description": "printfMethods_consolePrintf",
      "expected-problems": null,
      "expected-linenumbers": [
        280
      ],
      "code": ""
    },
    {
      "description": "printfMethods_consoleFormat",
      "expected-problems": null,
      "expected-linenumbers": [
        285
      ],
      "code": ""
    },
    {
      "description": "printfMethods_consoleFormat_noErrorsWithEmptyArgs",
      "expected-problems": null,
      "expected-linenumbers": [
        290
      ],
      "code": "class Test {\n              void f() {\n                System.console().readLine();\n              }\n            }"
    },
    {
      "description": "printfMethods_consoleReadline",
      "expected-problems": null,
      "expected-linenumbers": [
        305
      ],
      "code": ""
    },
    {
      "description": "printfMethods_consoleReadPassword",
      "expected-problems": null,
      "expected-linenumbers": [
        310
      ],
      "code": ""
    },
    {
      "description": "nullArgument",
      "expected-problems": null,
      "expected-linenumbers": [
        315
      ],
      "code": "class Test {\n              void f() {\n                String.format(\"%s %s\", null, null);\n              }\n            }"
    },
    {
      "description": "javaUtilTime",
      "expected-problems": null,
      "expected-linenumbers": [
        330
      ],
      "code": "import java.time.*;\n\nclass Test {\n  void f() {\n    System.err.printf(\"%tY\", LocalDateTime.ofInstant(Instant.now(), ZoneId.systemDefault()));\n    System.err.printf(\"%tQ\", Instant.now());\n    System.err.printf(\n        \"%tZ\",\n        ZonedDateTime.of(\n            LocalDate.of(2018, 12, 27), LocalTime.of(17, 0), ZoneId.of(\"Europe/London\")));\n  }\n}"
    },
    {
      "description": "number",
      "expected-problems": null,
      "expected-linenumbers": [
        352
      ],
      "code": "class Test {\n              void f(Number n) {\n                System.err.printf(\"%x\", n);\n              }\n            }"
    },
    {
      "description": "invalidIndex",
      "expected-problems": null,
      "expected-linenumbers": [
        367
      ],
      "code": "class T {\n              public static void main(String[] args) {\n                // BUG: Diagnostic contains: Illegal format argument index\n                System.err.printf(\" %0$2s) %s\", args[0], args[1]);\n              }\n            }"
    },
    {
      "description": "stringFormattedNegativeCase",
      "expected-problems": null,
      "expected-linenumbers": [
        383
      ],
      "code": "class Test {\n              void f() {\n                \"%s %s\".formatted(\"foo\", \"baz\");\n              }\n            }"
    },
    {
      "description": "stringFormattedPositiveCase",
      "expected-problems": null,
      "expected-linenumbers": [
        398
      ],
      "code": "class Test {\n              void f() {\n                // BUG: Diagnostic contains: missing argument for format specifier\n                \"%s %s %s\".formatted(\"foo\", \"baz\");\n              }\n            }"
    },
    {
      "description": "nonConstantStringFormattedNegativeCase",
      "expected-problems": null,
      "expected-linenumbers": [
        414
      ],
      "code": "class Test {\n              void f(String f) {\n                f.formatted(\"foo\", \"baz\");\n              }\n            }"
    },
    {
      "description": "finalVariable_isConstant",
      "expected-problems": null,
      "expected-linenumbers": [
        429
      ],
      "code": "class T {\n              public static void main() {\n                final String formatString = \" %0$2s) %s\";\n                // BUG: Diagnostic contains:\n                System.err.printf(formatString, \"foo\", \"bar\");\n              }\n            }"
    },
    {
      "description": "effectivelyFinalVariable_isNotConstant",
      "expected-problems": null,
      "expected-linenumbers": [
        446
      ],
      "code": "class T {\n              public static void main() {\n                String formatString = \" %0$2s) %s\";\n                System.err.printf(formatString, \"foo\", \"bar\");\n              }\n            }"
    }
  ]
}